#/*
# * Copyright (c) 2021, 2021, Oracle and/or its affiliates. All rights reserved.
# * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
# *
# * Licensed under the Universal Permissive License v 1.0 as shown at http://oss.oracle.com/licenses/upl.
# */
#
# ------
# Test that set.js does not deopt when loading from aux cache.
# ------
#
> mkdir ${TMP_DIR}/set
> cd ${TMP_DIR}/set
>[0?] js --experimental-options --engine.TraceCache --engine.CacheStore=${TMP_DIR}/set.image ${TEST_DIR}/resources/set.js
# [GR-70746] Work around transient deopts due to speculative guard movement
>[0?] js --experimental-options --engine.TraceCache --engine.Cache=${TMP_DIR}/set.image ${TEST_DIR}/resources/set.js
# Here, we assert that the output is empty (i.e., no compilations/deopts happen)
> js --experimental-options --vm.XX:+TraceDeoptimizationDetails --engine.TraceCompilation --engine.CacheLoad=${TMP_DIR}/set.image ${TEST_DIR}/resources/set.js
